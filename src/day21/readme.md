Heavily inspired by [this](https://pastebin.com/NiP2VzeA)
